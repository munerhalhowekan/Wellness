<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Manage Exercises ‚Äî Wellness Admin</title>
<style>
:root{
  --bg:#1c1c1c; --layer:#222; --card:#2a2a2a; --text:#fff; --muted:#cfcfcf;
  --border:#3a3a3a; --accent:#ff6600; --accent2:#ff8533; --danger:#c33;
  --shadow:0 0 18px rgba(255,102,0,.28);
}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;background:var(--bg);color:var(--text);font-family:"Poppins","Segoe UI",system-ui,Arial,sans-serif}

/* Header */
header{
  position:sticky;top:0;z-index:60;background:var(--layer);border-bottom:1px solid var(--border);
  display:flex;align-items:center;justify-content:space-between;padding:12px 18px;box-shadow:0 4px 12px rgba(0,0,0,.25);
}
.hamburger{cursor:pointer;font-size:24px;user-select:none}
.page{font-weight:800;letter-spacing:.3px}
.logo-link{display:flex;align-items:center}
.logo-img{width:120px;height:auto;object-fit:contain}

/* Drawer */
.drawer{
  position:fixed;left:-260px;top:0;height:100vh;width:260px;background:var(--card);
  border-right:1px solid var(--border);box-shadow:16px 0 30px rgba(0,0,0,.45);
  padding:18px;z-index:80;transition:left .28s ease;
}
.drawer.open{left:0}
.drawer h4{margin:4px 8px 12px;color:var(--accent)}
.drawer a{display:block;color:var(--text);text-decoration:none;padding:10px;border-radius:10px;margin:6px 0}
.drawer a:hover{background:rgba(255,102,0,.15)}
.drawer a.active{background:var(--accent);color:#fff}
.overlay{position:fixed;inset:0;background:rgba(0,0,0,.5);display:none;z-index:70}
.overlay.show{display:block}

/* Layout */
main{
  padding:22px;
  max-width:1300px;
  margin:0 auto;
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:22px;
}
.container{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:14px;
  box-shadow:var(--shadow);
  padding:18px;
  min-height:60vh;
  display:flex;
  flex-direction:column;
}
.container header.section-head{
  display:flex;align-items:center;justify-content:space-between;margin-bottom:12px
}
.section-title{font-size:1.2rem;font-weight:800;color:var(--accent)}
.section-actions{display:flex;gap:8px}
.btn{
  background:var(--accent);color:#fff;border:none;border-radius:10px;padding:9px 14px;font-weight:800;cursor:pointer
}
.btn:hover{background:var(--accent2)}
.btn.ghost{background:#4a4a4a}
.btn.danger{background:var(--danger)}
.searchbar{
  display:flex;align-items:center;background:var(--layer);border:1px solid var(--border);border-radius:10px;padding:8px 10px;margin-bottom:12px
}
.searchbar input{flex:1;background:transparent;border:none;outline:none;color:var(--text)}
.grid{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;overflow:auto}
.card{
  background:var(--layer);border:1px solid var(--border);border-radius:12px;padding:12px;display:flex;flex-direction:column;gap:6px
}
.card h3{margin:0;color:var(--accent);font-size:1rem}
.card p{margin:0;color:var(--muted);font-size:.9rem}
.card .actions{margin-top:8px;display:flex;gap:8px;flex-wrap:wrap}
.pill{
  display:inline-flex;align-items:center;gap:6px;background:#333;border:1px solid var(--border);color:#fff;padding:6px 10px;border-radius:999px;font-size:.85rem
}

/* Modals */
.modal{position:fixed;inset:0;background:rgba(0,0,0,.65);display:none;align-items:center;justify-content:center;padding:16px;z-index:90}
.modal.open{display:flex}
.sheet{
  width:min(720px,96vw);max-height:92vh;overflow:auto;
  background:var(--card);border:1px solid var(--border);border-radius:14px;box-shadow:var(--shadow);padding:18px;position:relative
}
.sheet h2{margin:0 0 12px;color:var(--accent);text-align:center}
.sheet .close{position:absolute;right:12px;top:10px;font-size:18px;cursor:pointer}
.field{display:flex;gap:10px;margin:10px 0}
.field label{min-width:140px;color:var(--muted);font-weight:700}
.field input[type="text"]{flex:1;background:#2f2f2f;border:1px solid var(--border);color:#fff;border-radius:8px;padding:10px}
.hr{height:1px;background:var(--border);margin:12px 0}

/* Exercise picker list */
.picklist{border:1px solid var(--border);border-radius:12px;background:#2a2a2a;padding:10px;max-height:46vh;overflow:auto}
.pick-row{display:grid;grid-template-columns:28px 1fr 78px 78px;align-items:center;gap:8px;padding:6px 0;border-bottom:1px dashed #3a3a3a}
.pick-row:last-child{border-bottom:none}
.pick-row input[type="number"]{width:100%;background:#393939;border:1px solid var(--border);color:#fff;border-radius:8px;padding:6px;text-align:center}
.pick-row.disabled{opacity:.5}

/* Modal actions */
.sheet .actions{display:flex;justify-content:flex-end;gap:10px;margin-top:12px}

/* Responsive */
@media (max-width:1000px){
  main{grid-template-columns:1fr}
  .grid{grid-template-columns:repeat(2,1fr)}
}
@media (max-width:600px){
  .grid{grid-template-columns:1fr}
}
</style>
</head>
<body>

<!-- Drawer + overlay -->
<aside id="drawer" class="drawer" aria-hidden="true">
  <h4>Admin Navigation</h4>
  <a href="admin-dashboard.html">üè† Dashboard</a>
  <a href="manage-users.html">üë• Manage Users</a>
  <a href="manage-exercises.html" class="active">üí™ Manage Exercises</a>
  <a href="manage-diet.html">ü•ó Manage Diet Plans</a>
</aside>
<div id="overlay" class="overlay" onclick="toggleDrawer(false)"></div>

<!-- Header -->
<header>
  <div class="hamburger" onclick="toggleDrawer()">‚ò∞</div>
  <div class="page">Manage Exercises</div>
  <a href="admin-dashboard.html" class="logo-link">
    <img src="wellness logo.png" alt="Wellness Logo" class="logo-img">
  </a>
</header>

<main>
  <!-- LEFT: EXERCISES -->
  <section class="container" id="leftCol">
    <header class="section-head">
      <div class="section-title">Exercises</div>
      <div class="section-actions">
        <button class="btn" onclick="openAddExercise()">+ Add Exercise</button>
      </div>
    </header>

    <div class="searchbar">
      <input id="exSearch" type="text" placeholder="Search exercises..." oninput="renderExercises()">
    </div>

    <div id="exerciseGrid" class="grid" aria-live="polite"></div>
  </section>

  <!-- RIGHT: RECOMMENDED WORKOUTS -->
  <section class="container" id="rightCol">
    <header class="section-head">
      <div class="section-title">Recommended Workouts</div>
      <div class="section-actions">
        <button class="btn" onclick="openAddWorkout()">+ Add Workout</button>
      </div>
    </header>

    <div id="workoutGrid" class="grid" aria-live="polite"></div>
  </section>
</main>

<!-- ADD EXERCISE MODAL -->
<div id="exerciseModal" class="modal" aria-hidden="true">
  <div class="sheet" role="dialog" aria-modal="true" aria-labelledby="exTitle">
    <span class="close" onclick="closeExerciseModal()">‚úï</span>
    <h2 id="exTitle">Add Exercise</h2>
    <div class="field">
      <label for="exName">Exercise name</label>
      <input id="exName" type="text" placeholder="e.g. Lat Pulldown">
    </div>
    <div class="field">
      <label for="exGroup">Muscle group</label>
      <input id="exGroup" type="text" placeholder="e.g. Back">
    </div>
    <div class="actions">
      <button class="btn ghost" onclick="closeExerciseModal()">Cancel</button>
      <button class="btn" onclick="saveExercise()">Save</button>
    </div>
  </div>
</div>

<!-- ADD/EDIT WORKOUT MODAL -->
<div id="workoutModal" class="modal" aria-hidden="true">
  <div class="sheet" role="dialog" aria-modal="true" aria-labelledby="woTitle">
    <span class="close" onclick="closeWorkoutModal()">‚úï</span>
    <h2 id="woTitle">Add Workout</h2>

    <div class="field">
      <label for="woName">Workout name</label>
      <input id="woName" type="text" placeholder="e.g. Back & Biceps">
    </div>

    <div class="hr"></div>
    <p style="margin:6px 0 10px;color:var(--muted)">Select exercises and set default sets & reps:</p>

    <div id="pickList" class="picklist"></div>

    <div class="actions">
      <button class="btn ghost" onclick="closeWorkoutModal()">Cancel</button>
      <button class="btn" id="woSaveBtn" onclick="saveWorkout()">Save</button>
    </div>
  </div>
</div>

<script>
/* ===== Drawer ===== */
function toggleDrawer(force){
  const d=document.getElementById('drawer'),o=document.getElementById('overlay');
  const open=(typeof force==='boolean')?force:!d.classList.contains('open');
  d.classList.toggle('open',open);o.classList.toggle('show',open);
}
document.querySelectorAll('#drawer a').forEach(a=>a.addEventListener('click',()=>toggleDrawer(false)));

/* ===== Data ===== */
let exercises = [
  { id: 'squat', name:'Squat', group:'Legs' },
  { id: 'pulldown', name:'Lat Pulldown', group:'Back' },
  { id: 'bench', name:'Bench Press', group:'Chest' },
  { id: 'deadlift', name:'Deadlift', group:'Back' },
  { id: 'curl', name:'Biceps Curl', group:'Arms' },
  { id: 'plank', name:'Plank', group:'Core' },
  { id: 'row', name:'Barbell Row', group:'Back' },
  { id: 'ohp', name:'Shoulder Press', group:'Shoulders' }
];

let workouts = [
  { id:'backbi', name:'Back & Biceps', items:[
    { exId:'pulldown', sets:3, reps:10 },
    { exId:'row', sets:4, reps:8 },
    { exId:'curl', sets:4, reps:12 }
  ]},
  { id:'legscore', name:'Legs & Core', items:[
    { exId:'squat', sets:4, reps:10 },
    { exId:'plank', sets:3, reps:60 }
  ]}
];

/* ===== Renders ===== */
function renderExercises(){
  const q = (document.getElementById('exSearch').value||'').trim().toLowerCase();
  const grid = document.getElementById('exerciseGrid');
  grid.innerHTML = '';
  exercises
    .filter(e => e.name.toLowerCase().includes(q) || e.group.toLowerCase().includes(q))
    .forEach((e,idx)=>{
      const card = document.createElement('div');
      card.className = 'card';
      card.innerHTML = `
        <h3>${e.name}</h3>
        <p>${e.group}</p>
        <div class="actions">
          <button class="ghost" onclick="editExercise(${idx})">Edit</button>
          <button class="danger" onclick="deleteExercise(${idx})">Delete</button>
        </div>
      `;
      grid.appendChild(card);
    });
}
function renderWorkouts(){
  const grid = document.getElementById('workoutGrid');
  grid.innerHTML = '';
  workouts.forEach((w,idx)=>{
    const count = w.items.length;
    const tags = w.items.slice(0,3).map(it=>{
      const ex = exercises.find(e=>e.id===it.exId);
      return ex ? `<span class="pill">${ex.name}</span>` : '';
    }).join(' ');
    const card = document.createElement('div');
    card.className = 'card';
    card.innerHTML = `
      <h3>${w.name}</h3>
      <p>${count} exercise${count!==1?'s':''}</p>
      <div style="display:flex;flex-wrap:wrap;gap:6px;margin-top:4px">${tags}</div>
      <div class="actions">
        <button class="ghost" onclick="openEditWorkout(${idx})">Edit</button>
        <button class="danger" onclick="deleteWorkout(${idx})">Delete</button>
      </div>
    `;
    grid.appendChild(card);
  });
}
renderExercises();
renderWorkouts();

/* ===== Exercises CRUD ===== */
let editingExerciseIndex = null;

function openAddExercise(){
  editingExerciseIndex = null;
  document.getElementById('exTitle').textContent = 'Add Exercise';
  document.getElementById('exName').value = '';
  document.getElementById('exGroup').value = '';
  document.getElementById('exerciseModal').classList.add('open');
}
function editExercise(idx){
  editingExerciseIndex = idx;
  document.getElementById('exTitle').textContent = 'Edit Exercise';
  document.getElementById('exName').value = exercises[idx].name;
  document.getElementById('exGroup').value = exercises[idx].group;
  document.getElementById('exerciseModal').classList.add('open');
}
function closeExerciseModal(){
  document.getElementById('exerciseModal').classList.remove('open');
}
function saveExercise(){
  const name = document.getElementById('exName').value.trim();
  const group = document.getElementById('exGroup').value.trim() || '(none)';
  if(!name){ alert('Please enter exercise name.'); return; }

  if(editingExerciseIndex===null){
    const id = name.toLowerCase().replace(/[^a-z0-9]+/g,'-') + '-' + (crypto?.randomUUID?.().slice(0,4) || Math.floor(Math.random()*9999));
    exercises.push({ id, name, group });
  }else{
    exercises[editingExerciseIndex].name = name;
    exercises[editingExerciseIndex].group = group;
  }
  closeExerciseModal();
  renderExercises();
}

/* Delete exercise (does not cascade; workouts keep items with that exId if any) */
function deleteExercise(idx){
  if(!confirm('Delete this exercise?')) return;
  const removed = exercises.splice(idx,1)[0];
  // Optional: also remove from workouts if you want strict consistency
  // workouts.forEach(w=> w.items = w.items.filter(it => it.exId !== removed.id));
  renderExercises();
  renderWorkouts();
}

/* ===== Workouts CRUD ===== */
let editingWorkoutIndex = null;   // null means adding
function openAddWorkout(){
  editingWorkoutIndex = null;
  document.getElementById('woTitle').textContent = 'Add Workout';
  document.getElementById('woName').value = '';
  buildPicker({items:[]});
  document.getElementById('workoutModal').classList.add('open');
}
function openEditWorkout(idx){
  editingWorkoutIndex = idx;
  document.getElementById('woTitle').textContent = 'Edit Workout';
  document.getElementById('woName').value = workouts[idx].name;
  buildPicker(workouts[idx]);
  document.getElementById('workoutModal').classList.add('open');
}
function closeWorkoutModal(){
  document.getElementById('workoutModal').classList.remove('open');
}

/* Build checkbox picker with sets/reps per selected exercise */
function buildPicker(workout){
  const list = document.getElementById('pickList');
  list.innerHTML = '';
  // Map for quick lookup of selected (when editing)
  const selected = new Map();
  (workout.items||[]).forEach(it => selected.set(it.exId, {sets:it.sets, reps:it.reps}));

  exercises.forEach(ex=>{
    const row = document.createElement('div');
    row.className = 'pick-row';
    const isChecked = selected.has(ex.id);
    const sets = isChecked ? selected.get(ex.id).sets : 3;
    const reps = isChecked ? selected.get(ex.id).reps : 10;

    row.innerHTML = `
      <input type="checkbox" ${isChecked?'checked':''} aria-label="select ${ex.name}">
      <div>
        <div style="font-weight:700">${ex.name}</div>
        <div style="font-size:.85rem;color:var(--muted)">${ex.group}</div>
      </div>
      <input type="number" min="1" value="${sets}" ${!isChecked?'disabled':''} aria-label="sets">
      <input type="number" min="1" value="${reps}" ${!isChecked?'disabled':''} aria-label="reps">
    `;
    const cb = row.querySelector('input[type="checkbox"]');
    const setsInput = row.querySelectorAll('input[type="number"]')[0];
    const repsInput = row.querySelectorAll('input[type="number"]')[1];

    cb.addEventListener('change',()=>{
      const on = cb.checked;
      setsInput.disabled = !on;
      repsInput.disabled = !on;
      row.classList.toggle('disabled', !on);
    });

    if(!isChecked){ row.classList.add('disabled'); }
    // Save identifiers for collection later
    row.dataset.exId = ex.id;
    list.appendChild(row);
  });
}

/* Save workout from picker */
function saveWorkout(){
  const name = document.getElementById('woName').value.trim();
  if(!name){ alert('Please enter workout name.'); return; }

  const rows = [...document.querySelectorAll('#pickList .pick-row')];
  const items = [];
  rows.forEach(r=>{
    const cb = r.querySelector('input[type="checkbox"]');
    if(cb.checked){
      const sets = Math.max(1, +r.querySelectorAll('input[type="number"]')[0].value || 1);
      const reps = Math.max(1, +r.querySelectorAll('input[type="number"]')[1].value || 1);
      items.push({ exId:r.dataset.exId, sets, reps });
    }
  });

  if(items.length===0){ alert('Select at least one exercise.'); return; }

  if(editingWorkoutIndex===null){
    const id = name.toLowerCase().replace(/[^a-z0-9]+/g,'-') + '-' + (crypto?.randomUUID?.().slice(0,4) || Math.floor(Math.random()*9999));
    workouts.push({ id, name, items });
  }else{
    workouts[editingWorkoutIndex].name = name;
    workouts[editingWorkoutIndex].items = items;
  }
  closeWorkoutModal();
  renderWorkouts();
}

function deleteWorkout(idx){
  if(!confirm('Delete this workout?')) return;
  workouts.splice(idx,1);
  renderWorkouts();
}
</script>
</body>
</html>
